# 守沪者——基于公众参与的城市治安协同治理系统
### 同济大学计算机专业数据库课设项目

面向公众举报与公安协同的现代化案件管理平台，涵盖用户举报、案件研判、行政区数据可视化以及全链路品牌化体验。

## ✨ 核心功能
- **实名注册与个人资料**：注册即收集姓名 / 身份证 / 性别 / 出生日期 / 地址 / 联系方式，用户中心提供“个人信息 / 我的举报 / 我要举报”分栏，字段与后台人员库一致。
- **案件全流程管理**：管理员可创建、编辑、删除、导入案件，能够修改全部字段并在状态回退时自动清理后续时间戳；用户在案件达到“立案侦查”前可自主修改非状态信息。
- **行政区与数据看板**：案件列表与仪表盘优先使用后端 `district` 字段；“各行政区案件数量”图表支持全量案件、纵轴仅显示整数。
- **多媒体材料**：后端开放 `/uploads/**` 静态资源；用户与管理员详情页可预览图片、下载其他附件。
- **人员/警员联动删除**：删除操作带确认弹窗，并同步清理 `Case_Persons`、`Case_Officers` 等关联，支持一键“清理无效人员”。
- **品牌与 UI 规范**：前后台应用 “守沪者” 深色/浅色双主题、上海盾牌概念 Logo，登录、注册、首页以及所有编辑界面实现深背景浅文字或亮色风格的统一。

## 🛠️ 技术栈
### 后端
- Spring Boot 3.5.6、Spring Security、RESTful API、Jackson + Java 17 Records
- JPA/Hibernate 实现 Cases / Locations / Persons / Officers 等实体，支持角色权限映射
- WebMvc 配置文件访问、案件时间轴自动规范、Profile 独立接口

### 前端
- Vue 3 + Vite + Composition API
- Element Plus（深度自定义主题）、Vue Router、Axios
- ECharts 驱动案件类型/行政区统计图，自适应窗口尺寸

### 数据库
- 统一初始化脚本 `crime_platform_init.sql`（已合并所有历史迁移，建库/建表/字典一次完成）
- 核心表：`Cases`, `Locations`, `Persons`, `Officers`, `user_accounts`
- 关联表：`Case_Persons`, `Case_Officers`, `User_Roles`
- 权限表：`Roles`, `Permissions`, `Role_Permissions`
- 关键增强：案件来源含“导入案件”、多媒体 JSON 字段、实名信息必填约束、外键级联删除

## 🚀 快速开始
### 环境要求
- Java 17+
- Node.js 18+（或兼容 LTS）
- MySQL 8.0+
- Maven 3.8+

### 1. 克隆项目
```bash
git clone https://github.com/BaBaLiBoo/Database_project.git
cd Database_project
```

### 2. 初始化数据库
```sql
-- 一体化脚本（自动建库建表并写入基础数据）
mysql -u root -p < crime_platform_init.sql
```
脚本会创建 `crime_platform_db` 并完成结构修复，无需额外补丁或顺序依赖。

### 3. 启动后端
```bash
cd crime-platform-api
mvn clean package
mvn spring-boot:run
# 或在 IDE 中直接运行 CrimePlatformApiApplication
```

### 4. 启动前端
```bash
cd crime-platform-ui
npm install
npm run dev
```
默认使用 Vite Dev Server，可通过终端提示访问（通常为 http://localhost:5173）。

### 5. 常见问题
- **上传图片无法访问**：确保 Spring Boot `file.upload.dir` 指向可读目录，且应用运行账户拥有权限。
- **行政区统计不准确**：编辑案件时务必选择行政区；仪表盘会优先读取 `district` 字段。
- **人员/警员删除失败**：可在人员列表点击“清理无效人员”，自动删除缺失姓名/身份证的历史脏数据。

> 如需生产部署，可启用 HTTPS / 反向代理，并执行 `npm run build` + `java -jar target/*.jar` 的发布流程。欢迎继续扩展功能！
